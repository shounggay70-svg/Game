<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Simple Drawing App</title>
<style>
  body { text-align: center; font-family: Arial, sans-serif; background: #f0f0f0;
 
  }
  canvas { border: 2px solid black; margin-top: 10px; cursor: crosshair; }
  #controls { margin-top: 10px; }
  button {
  padding: 8px 14px;
  margin: 4px;
  font-size: 14px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
 background: linear-gradient(45deg, #00f2fe, #4facfe, #ff00d4);
 box-shadow: 0 0 15px rgba(0,255,255,0.6);
      animation: gradientMove 3s infinite alternate;
  color: white;
  transition: 0.2s ease;
}
button:hover {
  box-shadow: 0 0 25px #ff00d4, 0 0 35px #00fff2;
  transform: translateY(-1px);
}
button:active {
  transform: scale(0.96);
}
</style>
</head>
<body>

<h1>ðŸŽ¨ Drawing Canvas</h1>
<div id="controls">
  Color: <input type="color" id="colorPicker" value="#000000">
  Brush Size: <input type="number" id="brushSize" value="5" min="1" max="50">
  Background: <input type="color" id="bgColorPicker" value="#ffffff">
  <button id="clearBtn">Clear</button>
  
  <select id="shapeSelector">
  <option value="free">Free Draw</option>
  <option value="circle">Circle</option>
  <option value="rect">Rectangle</option>
</select>
</div>

<canvas id="drawingCanvas" width="800" height="500"></canvas>
<div id="controls">
  
  <button id="saveBtn">Save Image</button> <!-- Save button added here -->
  <button id="eraserBtn">Eraser</button>
  <button id="undoBtn">Undo</button>
<button id="redoBtn">Redo</button>
</div>

<script>

const canvas = document.getElementById('drawingCanvas');
const ctx = canvas.getContext('2d');
const bgColorPicker = document.getElementById('bgColorPicker');


let drawing = false;
let color = document.getElementById('colorPicker').value;
let brushSize = document.getElementById('brushSize').value;

// Mouse events
canvas.addEventListener('mousedown', (e) => { drawing = true; draw(e); });
canvas.addEventListener('mouseup', () => { drawing = false; ctx.beginPath(); });
canvas.addEventListener('mouseout', () => { drawing = false; ctx.beginPath(); });
canvas.addEventListener('mousemove', draw);
document.getElementById('saveBtn').addEventListener('click', () => {
  const link = document.createElement('a');
  link.download = 'my_drawing.png';
  link.href = canvas.toDataURL();
  link.click();
});
// Controls
document.getElementById('colorPicker').addEventListener('change', (e) => color = e.target.value);
document.getElementById('brushSize').addEventListener('change', (e) => brushSize = e.target.value);
let erasing = false;

document.getElementById('eraserBtn').addEventListener('click', () => {
  erasing = !erasing;
  ctx.strokeStyle = erasing ? '#f0f0f0' : color; // background color á€”á€²á€·á€¡á€á€° erase
});
let shape = 'free'; // default
document.getElementById('shapeSelector').addEventListener('change', e => {
  shape = e.target.value;
});
document.getElementById('clearBtn').addEventListener('click', () => {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
});
bgColorPicker.addEventListener('change', (e) => {
  canvas.style.backgroundColor = e.target.value;
});

let history = [];
let step = -1;

function saveState() {
  step++;
  if (step < history.length) {
    history.length = step;
  }
  history.push(canvas.toDataURL());
}

// initial empty canvas save
saveState();

canvas.addEventListener('mouseup', () => {
  drawing = false;
  ctx.beginPath();
  saveState(); // ðŸ”¥ á€’á€®á€œá€­á€¯á€„á€ºá€¸á€™á€•á€«á€›á€„á€º undo á€™á€›
});
document.getElementById('undoBtn').addEventListener('click', () => {
  if (step <= 0) return;
  step--;
  let img = new Image();
  img.src = history[step];
  img.onload = () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(img, 0, 0);
  };
});
document.getElementById('redoBtn').addEventListener('click', () => {
  if (step >= history.length - 1) return;
  step++;
  let img = new Image();
  img.src = history[step];
  img.onload = () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(img, 0, 0);
  };
});
document.getElementById('saveBtn').addEventListener('click', () => {
  fillBackground();
  const link = document.createElement('a');
  link.download = 'drawing.png';
  link.href = canvas.toDataURL();
  link.click();
});
function draw(e) {
  if(!drawing) return;

  ctx.lineWidth = brushSize;
  ctx.lineCap = 'round';
  ctx.strokeStyle = erasing ? '#f0f0f0' : color;

  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;

  if(shape === 'free') {
    ctx.lineTo(x, y);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(x, y);
  } 
  else if(shape === 'circle') {
    ctx.beginPath();
    ctx.arc(x, y, brushSize*5, 0, Math.PI*2);
    ctx.stroke();
    ctx.beginPath();
  } 
  else if(shape === 'rect') {
    ctx.beginPath();
    ctx.strokeRect(x - brushSize*5, y - brushSize*5, brushSize*10, brushSize*10);
    ctx.beginPath();
  }
}
function fillBackground() {
  ctx.save();
  ctx.globalCompositeOperation = 'destination-over';
  ctx.fillStyle = canvas.style.backgroundColor || '#ffffff';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.restore();
}
</script>

</body>
</html>